<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en-us lang=en-us><head>&lt; <title itemprop=name>Home Assistant Container Part 7: Backing up Home Assistant Container :: Sequr (dev)</title>
<script defer language=javascript type=text/javascript src=/js/bundle.min.145453261a7755f5042a854c4213501d215a8fbe34c08d181c40f803f1315e74.js></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=robots content="noodp, noydir"><meta name=googlebot content="noodp, noydir"><link rel=canonical href=https://dev.sequr.be/blog/automation/ha_container/pt07_backup/ itemprop=url><meta name=url content="https://dev.sequr.be/blog/automation/ha_container/pt07_backup/"><link rel=icon href=favicon.ico><meta itemprop=name content="Home Assistant Container Part 7: Backing up Home Assistant Container"><meta itemprop=description content="In this seventh part of the Home Assistant Container series we’ll check out options for backing up Home Assistant Container"><meta itemprop=datePublished content="2022-09-09T00:00:00+00:00"><meta itemprop=dateModified content="2024-09-05T00:00:00+00:00"><meta itemprop=wordCount content="999"><meta itemprop=image content="https://dev.sequr.be/blog/automation/ha_container/pt07_backup/cover.png"><meta itemprop=keywords content="Home Automation,Home Assistant,Container,Docker,Backup,Back-Up,Rsync,Duplicati"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://dev.sequr.be/blog/automation/ha_container/pt07_backup/cover.png"><meta name=twitter:title content="Home Assistant Container Part 7: Backing up Home Assistant Container"><meta name=twitter:description content="In this seventh part of the Home Assistant Container series we’ll check out options for backing up Home Assistant Container"><meta property="og:url" content="https://dev.sequr.be/blog/automation/ha_container/pt07_backup/"><meta property="og:site_name" content="Sequr (dev)"><meta property="og:title" content="Home Assistant Container Part 7: Backing up Home Assistant Container"><meta property="og:description" content="In this seventh part of the Home Assistant Container series we’ll check out options for backing up Home Assistant Container"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2022-09-09T00:00:00+00:00"><meta property="article:modified_time" content="2024-09-05T00:00:00+00:00"><meta property="article:tag" content="Home Automation"><meta property="article:tag" content="Home Assistant"><meta property="article:tag" content="Container"><meta property="article:tag" content="Docker"><meta property="article:tag" content="Backup"><meta property="article:tag" content="Back-Up"><meta property="og:image" content="https://dev.sequr.be/blog/automation/ha_container/pt07_backup/cover.png"><meta name=description content="In this seventh part of the Home Assistant Container series we&rsquo;ll check out options for backing up Home Assistant Container"><meta itemprop=description content="In this seventh part of the Home Assistant Container series we&rsquo;ll check out options for backing up Home Assistant Container"><meta property="og:updated_time" content="2024-09-05T00:00:00Z"><link rel=sitemap type=application/xml title=Sitemap href=https://dev.sequr.be/sitemap.xml><meta name=apple-mobile-web-app-title content="Sequr (dev)"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black"><link type=text/css rel=stylesheet href=/css/bundle.min.94a339836f89f0d25f31980cb6b0631da21e20af128308747ce44e0525eb16ef.css integrity="sha256-lKM5g2+J8NJfMZgMtrBjHaIeIK8Sgwh0fOROBSXrFu8=" crossorigin=anonymous><style>body{--sidebar-bg-color:#202020;--sidebar-img-border-color:#515151;--sidebar-p-color:#909090;--sidebar-h1-color:#FFF;--sidebar-a-color:#FFF;--sidebar-socials-color:#FFF;--text-color:#222;--bkg-color:#FAF9F6;--post-title-color:#303030;--list-color:#5A5A5A;--link-color:#268BD2;--date-color:#515151;--table-border-color:#E5E5E5;--table-stripe-color:#F9F9F9;--code-color:#000;--code-background-color:#E5E5E5;--code-block-color:#FFF;--code-block-background-color:#272822;--moon-sun-color:#FFF;--moon-sun-background-color:#515151}body.dark-theme{--text-color:#EEE;--bkg-color:#121212;--post-title-color:#DBE2E9;--list-color:#9D9D9D;--link-color:#268BD2;--date-color:#9A9A9A;--table-border-color:#515151;--table-stripe-color:#202020;--code-color:#FFF;--code-background-color:#515151;--code-block-color:#FFF;--code-block-background-color:#272822}body{background-color:var(--bkg-color)}</style></head><body><div class=wrapper><aside class=sidebar><div class="container sidebar-sticky"><div class=light-dark align=right><button class=btn-light-dark title="Toggle light/dark mode"><svg class="moon" width="1em" height="1em" viewBox="0 0 16 16"><path fill="currentcolor" d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/></svg><svg class="sun" width="1em" height="1em" viewBox="0 0 16 16"><path fill="currentcolor" d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></svg></button></div><div class=sidebar-about><h1 class=brand><a href=https://dev.sequr.be/><img src=logo.png alt="brand image">
</a><a href=https://dev.sequr.be/><h1>Sequr (dev)</h1></a></h1><p class=lead>Dev version of sequr.be. This site may break at any time.</p></div><nav><ul class=sidebar-nav><li class=heading><a href=/about/>About</a></li><li class=heading>Blog</li><li class=heading><a href=/privacy/>Privacy</a></li></ul></nav><a target=_blank class=social title="RSS Feed" href=/posts/index.xml><svg width="1em" height="1.2em" viewBox="0 0 1280 1280"><g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="currentcolor"><path d="M2295 11929c-284-12-642-45-707-65-17-5-18-63-18-1039 0-569 4-1036 8-1039 5-3 74 6 153 19 510 86 1168 95 1789 25 1348-153 2602-677 3670-1531 385-308 820-744 1126-1129 842-1060 1362-2313 1514-3650 70-621 61-1279-25-1789-13-79-22-148-19-153 3-4 471-8 1039-8h1035l5 23c51 225 85 942 67 1419-23 605-77 1044-198 1617-294 14e2-927 2734-1823 3846-1043 1295-2364 2259-3909 2854-1158 447-2451 656-3707 6e2z"/><path d="M2255 7845c-269-25-620-81-667-106-17-9-18-55-18-899 0-706 3-890 13-890 6 0 66 18 132 41 130 44 288 79 467 105 154 21 577 30 749 15 1207-107 2267-823 2814-1902 166-327 268-637 330-1001 38-227 48-384 42-662-8-348-44-590-126-831-23-66-41-126-41-132 0-10 184-13 890-13 844 0 890 1 899 18 27 50 88 452 110 725 14 162 14 624 1 782-59 703-233 1323-545 1945-481 956-1313 1788-2270 2268-620 310-1239 483-1940 542-165 14-669 10-840-5z"/><path d="M2519 3815c-391-66-725-336-868-703-79-201-96-462-45-677 83-344 338-641 666-774 116-47 205-69 330-80 412-39 811 153 1040 5e2 193 292 240 648 128 981-135 403-492 699-914 757-1e2 14-241 12-337-4z"/></g></svg></a><p class=footnote>&copy; 2019
• <a class="p-name u-url" href=https://sequr.be>DezeStijn</a>
• &lt;a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0&lt;/a></p></div></aside><main class="content container"><div class=post><div class=info><h1 class=post-title><a href=https://dev.sequr.be/blog/automation/ha_container/pt07_backup/>Home Assistant Container Part 7: Backing up Home Assistant Container</a></h1><div class=headline><div><span>DezeStijn - </span><time datetime=2022-09-09T00:00:00Z class=post-date>September 9, 2022
</time><span>- </span><span class=reading-time><span>5 mins read</span></span></div><ul class=tags><li class="tag-Home Automation"><a href=https://dev.sequr.be/tags/home-automation>Home Automation</a></li><li class="tag-Home Assistant"><a href=https://dev.sequr.be/tags/home-assistant>Home Assistant</a></li><li class=tag-Container><a href=https://dev.sequr.be/tags/container>Container</a></li><li class=tag-Docker><a href=https://dev.sequr.be/tags/docker>Docker</a></li><li class=tag-backup><a href=https://dev.sequr.be/tags/backup>backup</a></li><li class=tag-back-up><a href=https://dev.sequr.be/tags/back-up>back-up</a></li><li class=tag-rsync><a href=https://dev.sequr.be/tags/rsync>rsync</a></li><li class=tag-Duplicati><a href=https://dev.sequr.be/tags/duplicati>Duplicati</a></li></ul></div></div><h2 id=intro>Intro</h2><p>The September 2022 update for Home Assistant just dropped, so it&rsquo;s time to upgrade.
Before jumping to upgrading, however, it&rsquo;s always a good idea to pause and create a backup first.</p><p>Let&rsquo;s check out a few options for backing up Home Assistant Container.</p><h2 id=home-assistant-backup-integration>Home Assistant Backup Integration</h2><p>A first, and obvious, choice is using the built-in <a href=https://www.home-assistant.io/integrations/backup/ title="Home Assistant Backup integration" target=_blank>backup integration</a>.</p><p>Unless you removed the <code>default_config:</code> entry from your <code>configuration.yaml</code>, the backup integration is enabled by default.
If you did remove this line, you can selectively enable the backup integration by adding <code>backup:</code> to the HA configuration.</p><p>With this integration enabled, taking a backup is a simple 3-step process:</p><ol><li>In Home Assistant, go to <a href=https://my.home-assistant.io/redirect/backup/ title="Home Assistant Backup" target=_blank>Settings > System > Backups</a>.</li><li>Click the <code>+ Create Backup</code> button on the bottom-right and <code>Create</code> in the pop-up window.</li><li>Once the backup is created, download it to your local system by clicking the <code>⬇</code> button to the right of the created backup.</li></ol><p>And you&rsquo;re done :)
In case an upgrade fails, we can restore Home Assistant using the backup file to rollback the changes.</p><figure class=center><img src=habackup.png alt="Create a Home Assistant backup"><figcaption class=center>Creating a Home Assistant Backup</figcaption></figure><h2 id=backing-up-docker-volumes>Backing up Docker volumes</h2><p>The most important data within Home Assistant is stored within the <code>/config</code> folder inside the container.
This folder is exposed to our Docker volume at <code>/opt/homeassistant/config</code>.
So a backup of this folder, would keep our HA data safe.</p><p>Because a running Home Assistant could cause inconsistencies in the backed up data, it&rsquo;s a good idea to temporarily stop the HA Container while copying the data.
We can achieve this using a small script, which we could even run periodically.</p><p>We use <code>rsync</code> to copy the data, as it has some nice features which are ideal for doing periodic automated backups.
You may need to install it on your system first.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt update
</span></span><span style=display:flex><span>sudo apt install rsync
</span></span></code></pre></div><p>Next we write our script to perform the backup.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>sudo nano /opt/homeassistant/backup.sh
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Copy/paste the lines between the &#39;---&#39; and save with Ctrl+X</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Also copy the &#39;shebang&#39; starting with #!</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># ---</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#!/bin/bash</span>
</span></span><span style=display:flex><span>readonly SOURCE_DIR<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/opt/homeassistant/config&#34;</span>
</span></span><span style=display:flex><span>readonly BACKUP_DIR<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/mnt/backup/homeassistant&#34;</span>
</span></span><span style=display:flex><span>readonly BACKUP_PATH<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>BACKUP_DIR<span style=color:#e6db74>}</span><span style=color:#e6db74>/</span><span style=color:#66d9ef>$(</span>date <span style=color:#e6db74>&#39;+%F&#39;</span><span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>readonly LATEST_LINK<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>BACKUP_DIR<span style=color:#e6db74>}</span><span style=color:#e6db74>/latest&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mkdir -p <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>BACKUP_DIR<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>docker stop homeassistant
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>rsync -a --delete <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>SOURCE_DIR<span style=color:#e6db74>}</span><span style=color:#e6db74>/&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --link-dest <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>LATEST_LINK<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>BACKUP_PATH<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>rm -rf <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>LATEST_LINK<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>ln -s <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>BACKUP_PATH<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>LATEST_LINK<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>docker start homeassistant
</span></span><span style=display:flex><span><span style=color:#75715e># ---</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Make file executable</span>
</span></span><span style=display:flex><span>sudo chmod u+x /opt/homeassistant/backup.sh
</span></span></code></pre></div><p>The content of the Home Assistant configuration directory will be compared to our <code>latest</code> backup directory, which actually is a symbolic link to the most recent back-up folder.
New and modified files existing in the source directory will be copied to the backup directory, which is timestamped.
Files deleted in the source directory will also be removed in the backup directory (<code>--delete</code>).
Finally, files that didn&rsquo;t change between two back-ups will be visible in the back-up directory through hards links pointing to the originally backed up file (<code>--link-dest</code>).</p><p>On the first run, we won&rsquo;t have a <code>latest</code> directory to compare against, so rsync will do a full backup.</p><p>Once rsync has finished backing up, we remove the <code>latest</code> link and replace it with a link to the backup we just completed.</p><figure class=center><img src=rsyncbackup.png alt="Backup and latest link"><figcaption class=center>Our first backup and the &rsquo;latest&rsquo; link</figcaption></figure><h3 id=automatic-backups>Automatic backups</h3><p>We can now have this backup run automatically using a cronjob.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>sudo crontab -e
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Add the following lines at the end of the file</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>30</span> <span style=color:#ae81ff>23</span> * * <span style=color:#ae81ff>6</span> /opt/homeassistant/backup.sh &gt; /dev/null
</span></span><span style=display:flex><span><span style=color:#ae81ff>45</span> <span style=color:#ae81ff>23</span> * * <span style=color:#ae81ff>6</span> docker start homeassistant &gt; /dev/null
</span></span></code></pre></div><p>The commands above will run the backup every Saturday at 23:30 (11:30 PM).
We also add a fail-safe that will start the Home Assistant Docker container at 23:45 should the backup script have failed somehow.<br>The output of the scripts is sent to the void of <code>/dev/null</code>, however error messages will be logged.</p><h2 id=backing-up-via-duplicati>Backing up via Duplicati</h2><p><a href=http://www.duplicati.com/ title=Duplicati target=_blank>Duplicati</a> is a nice tool to do scheduled backups.
It not only allows you to store backups on a local or attached drive, but even to many differen cloud storage locations.
And backups can be restored on a file-level, so you don&rsquo;t have to overwrite everything if you ever need to restore a system.
Duplicati even gives you the option to encrypt your backups. Useful for when you backup to a remote system.</p><h3 id=docker-composeyaml>docker-compose.yaml</h3><p>Duplicati is a Docker container, so we again add an entry to our <code>docker-compose.yaml</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>services</span>:
</span></span><span style=display:flex><span>  [<span style=color:#ae81ff>...]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>duplicati</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>container_name</span>: <span style=color:#ae81ff>duplicati</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>duplicati/duplicati</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>restart</span>: <span style=color:#ae81ff>unless-stopped</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;8200:8200/tcp&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>environment</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>TZ=Europe/Brussels</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>volumes</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>/opt/duplicati/data:/data</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>/mnt/backup/duplicati:/backups</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>/opt:/source</span>
</span></span></code></pre></div><p>Running <code>docker-compose up -d</code> launches the Duplicati container which will host a web portal at <code>http://&lt;ip.of.our.box>:8200</code>.</p><h3 id=home-assistant-sidebar>Home Assistant sidebar</h3><p>We&rsquo;ve done it <a href=https://dev.sequr.be/blog/automation/ha_container/pt03_mariadb_influxdb/ title="Part 3: MariaDB and InfluxDB">a few</a> <a href=https://dev.sequr.be/blog/automation/ha_container/pt05_nodered/ title="Part 5: Node-RED">times</a> <a href=https://dev.sequr.be/blog/automation/ha_container/pt06_hassconfigurator/ title="Part 6: Editing configuration.yaml from within Home Assistant">before</a>.
Add an entry for Duplicati to the sidebar of our Home Assistant dashboard using the <del><code>panel-iframe</code></del> Web Dashboard.</p><p><strong>Note:</strong> This has changed since <a href=https://www.home-assistant.io/blog/2024/04/03/release-20244/#webpage-dashboard title="2024.4 release notes - webpage dashboard" target=_blank>Home Assistant 2024.4</a>.
You can now use a <a href=https://www.home-assistant.io/dashboards/dashboards/#webpage-dashboard title="Webpage dashboard" target=_blank>Webpage Dashboard</a> to embed a webpage in your dashboard.</p><p><del>Add the following lines to <code>configuration.yaml</code> (via the terminal or using <a href=https://dev.sequr.be/blog/automation/ha_container/pt06_hassconfigurator/ title="Part 6: Editing configuration.yaml from within Home Assistant">Configurator</a>):</del></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># Outdated, use web dashboard</span>
</span></span><span style=display:flex><span><span style=color:#f92672>panel_iframe</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>portainer</span>:     <span style=color:#75715e># part 3</span>
</span></span><span style=display:flex><span>    [<span style=color:#ae81ff>...]</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>nodered</span>:       <span style=color:#75715e># part 5</span>
</span></span><span style=display:flex><span>    [<span style=color:#ae81ff>...]</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>configurator</span>:  <span style=color:#75715e># part 6</span>
</span></span><span style=display:flex><span>    [<span style=color:#ae81ff>...]</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>duplicati</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>title</span>: <span style=color:#ae81ff>Duplicati</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>icon</span>: <span style=color:#ae81ff>mdi:backup-restore</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>url</span>: <span style=color:#ae81ff>http://192.168.10.106:8200</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>require_admin</span>: <span style=color:#66d9ef>true</span>
</span></span></code></pre></div><p>After restarting Home Assistant, we&rsquo;re able to open Duplicati from within the Home Assistant dashboard.</p><h3 id=configure-backup>Configure backup</h3><p>We can now open the Duplicati web portal via <code>http://&lt;ip.of.our.box>:8200</code> or via the Home Assistant sidebar and add a new backup.</p><p>Enter the details if your backup.
For example:</p><ol><li>General<ul><li>Name: Home Assistant</li><li>Encryption: No encryption</li></ul></li><li>Destination<ul><li>Storage Type: Local folder or drive</li><li>Manually type path: <code>/backups/homeassistant/</code><br>Test connection and create the directory.</li></ul></li><li>Source Data<ul><li>Source data: <code>/source/homeassistant/</code></li></ul></li><li>Schedule<ul><li>Automaticall run backups</li><li>Next time: next Wednesday at 23:30</li><li>Run again every: 1 weeks</li><li>Allowed days: Wed</li></ul></li><li>Options<ul><li>Backup retention: Smart backup retention</li></ul></li></ol><p>Once you saved the configuration, you can <code>Run now</code> to make a first backup and confirm everything works as expected.</p><figure class=center><img src=duplicatibackup.png alt="Duplicati dashboard"><figcaption class=center>Backing up Home Assistant</figcaption></figure><h2 id=upgrade>Upgrade</h2><p>We now have 3 methods of backing up our Home Assistant install.
So we should be safe to <a href=https://dev.sequr.be/blog/automation/ha_container/pt08_update/ title="Part 8: Update Home Assistant Container">update Home Assistant</a> to the latest version.</p><h2 id=changelog>Changelog</h2><ul><li>2024-09-05 - Reference Webpage dashboard replacing <code>iframe_panel</code> since 2024.04</li></ul><hr><div class=footer><a class=previous-post href="https://dev.sequr.be/blog/automation/ha_container/pt06_hassconfigurator/?ref=footer"><span style=font-weight:700>« Previous</span><br>Home Assistant Container Part 6: Editing...</a><div class=next-post><a href="https://dev.sequr.be/blog/automation/ha_container/pt08_update/?ref=footer"><span style=font-weight:700>Next »</span><br>Home Assistant Container Part 8: Update Home...</a></div></div></div></main><div class=article-toc><div class=toc-wrapper><h4 id=contents></h4><nav id=TableOfContents><ul><li><a href=#intro>Intro</a></li><li><a href=#home-assistant-backup-integration>Home Assistant Backup Integration</a></li><li><a href=#backing-up-docker-volumes>Backing up Docker volumes</a><ul><li><a href=#automatic-backups>Automatic backups</a></li></ul></li><li><a href=#backing-up-via-duplicati>Backing up via Duplicati</a><ul><li><a href=#docker-composeyaml>docker-compose.yaml</a></li><li><a href=#home-assistant-sidebar>Home Assistant sidebar</a></li><li><a href=#configure-backup>Configure backup</a></li></ul></li><li><a href=#upgrade>Upgrade</a></li><li><a href=#changelog>Changelog</a></li></ul></nav></div></div></div></body></html>