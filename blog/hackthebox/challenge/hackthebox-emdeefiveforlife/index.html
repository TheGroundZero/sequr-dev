<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en-us lang=en-us><head>&lt; <title itemprop=name>Emdee five for life :: Sequr (dev)</title>
<script defer language=javascript type=text/javascript src=/js/bundle.min.145453261a7755f5042a854c4213501d215a8fbe34c08d181c40f803f1315e74.js></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=robots content="noodp, noydir"><meta name=googlebot content="noodp, noydir"><link rel=canonical href=https://dev.sequr.be/blog/hackthebox/challenge/hackthebox-emdeefiveforlife/ itemprop=url><meta name=url content="https://dev.sequr.be/blog/hackthebox/challenge/hackthebox-emdeefiveforlife/"><link rel=icon href=favicon.ico><meta itemprop=name content="Emdee five for life"><meta itemprop=description content="Write-up of the Emdee five for life web challenge by L4mpje on HackTheBox.eu. Can you encrypt fast enough?"><meta itemprop=datePublished content="2019-08-13T09:04:52+00:00"><meta itemprop=dateModified content="2019-08-13T09:04:52+00:00"><meta itemprop=wordCount content="343"><meta itemprop=image content="https://dev.sequr.be/img/htb-L4mpje.jpg"><meta itemprop=keywords content="Challenge,HackTheBox.eu,L4mpje,Web"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://dev.sequr.be/img/htb-L4mpje.jpg"><meta name=twitter:title content="Emdee five for life"><meta name=twitter:description content="Write-up of the Emdee five for life web challenge by L4mpje on HackTheBox.eu. Can you encrypt fast enough?"><meta property="og:url" content="https://dev.sequr.be/blog/hackthebox/challenge/hackthebox-emdeefiveforlife/"><meta property="og:site_name" content="Sequr (dev)"><meta property="og:title" content="Emdee five for life"><meta property="og:description" content="Write-up of the Emdee five for life web challenge by L4mpje on HackTheBox.eu. Can you encrypt fast enough?"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2019-08-13T09:04:52+00:00"><meta property="article:modified_time" content="2019-08-13T09:04:52+00:00"><meta property="article:tag" content="Challenge"><meta property="article:tag" content="HackTheBox.eu"><meta property="article:tag" content="L4mpje"><meta property="article:tag" content="Web"><meta property="og:image" content="https://dev.sequr.be/img/htb-L4mpje.jpg"><meta name=description content="Write-up of the Emdee five for life web challenge by L4mpje on HackTheBox.eu. Can you encrypt fast enough?"><meta itemprop=description content="Write-up of the Emdee five for life web challenge by L4mpje on HackTheBox.eu. Can you encrypt fast enough?"><meta property="og:updated_time" content="2019-08-13T09:04:52Z"><link rel=sitemap type=application/xml title=Sitemap href=https://dev.sequr.be/sitemap.xml><meta name=apple-mobile-web-app-title content="Sequr (dev)"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black"><link type=text/css rel=stylesheet href=/css/bundle.min.94a339836f89f0d25f31980cb6b0631da21e20af128308747ce44e0525eb16ef.css integrity="sha256-lKM5g2+J8NJfMZgMtrBjHaIeIK8Sgwh0fOROBSXrFu8=" crossorigin=anonymous><style>body{--sidebar-bg-color:#202020;--sidebar-img-border-color:#515151;--sidebar-p-color:#909090;--sidebar-h1-color:#FFF;--sidebar-a-color:#FFF;--sidebar-socials-color:#FFF;--text-color:#222;--bkg-color:#FAF9F6;--post-title-color:#303030;--list-color:#5A5A5A;--link-color:#268BD2;--date-color:#515151;--table-border-color:#E5E5E5;--table-stripe-color:#F9F9F9;--code-color:#000;--code-background-color:#E5E5E5;--code-block-color:#FFF;--code-block-background-color:#272822;--moon-sun-color:#FFF;--moon-sun-background-color:#515151}body.dark-theme{--text-color:#EEE;--bkg-color:#121212;--post-title-color:#DBE2E9;--list-color:#9D9D9D;--link-color:#268BD2;--date-color:#9A9A9A;--table-border-color:#515151;--table-stripe-color:#202020;--code-color:#FFF;--code-background-color:#515151;--code-block-color:#FFF;--code-block-background-color:#272822}body{background-color:var(--bkg-color)}</style></head><body><div class=wrapper><aside class=sidebar><div class="container sidebar-sticky"><div class=light-dark align=right><button class=btn-light-dark title="Toggle light/dark mode"><svg class="moon" width="1em" height="1em" viewBox="0 0 16 16"><path fill="currentcolor" d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/></svg><svg class="sun" width="1em" height="1em" viewBox="0 0 16 16"><path fill="currentcolor" d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></svg></button></div><div class=sidebar-about><h1 class=brand><a href=https://dev.sequr.be/><img src=logo.png alt="brand image">
</a><a href=https://dev.sequr.be/><h1>Sequr (dev)</h1></a></h1><p class=lead>Dev version of sequr.be. This site may break at any time.</p></div><nav><ul class=sidebar-nav><li class=heading><a href=/about/>About</a></li><li class=heading>Blog</li><li class=heading><a href=/privacy/>Privacy</a></li></ul></nav><a target=_blank class=social title="RSS Feed" href=/posts/index.xml><svg width="1em" height="1.2em" viewBox="0 0 1280 1280"><g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="currentcolor"><path d="M2295 11929c-284-12-642-45-707-65-17-5-18-63-18-1039 0-569 4-1036 8-1039 5-3 74 6 153 19 510 86 1168 95 1789 25 1348-153 2602-677 3670-1531 385-308 820-744 1126-1129 842-1060 1362-2313 1514-3650 70-621 61-1279-25-1789-13-79-22-148-19-153 3-4 471-8 1039-8h1035l5 23c51 225 85 942 67 1419-23 605-77 1044-198 1617-294 14e2-927 2734-1823 3846-1043 1295-2364 2259-3909 2854-1158 447-2451 656-3707 6e2z"/><path d="M2255 7845c-269-25-620-81-667-106-17-9-18-55-18-899 0-706 3-890 13-890 6 0 66 18 132 41 130 44 288 79 467 105 154 21 577 30 749 15 1207-107 2267-823 2814-1902 166-327 268-637 330-1001 38-227 48-384 42-662-8-348-44-590-126-831-23-66-41-126-41-132 0-10 184-13 890-13 844 0 890 1 899 18 27 50 88 452 110 725 14 162 14 624 1 782-59 703-233 1323-545 1945-481 956-1313 1788-2270 2268-620 310-1239 483-1940 542-165 14-669 10-840-5z"/><path d="M2519 3815c-391-66-725-336-868-703-79-201-96-462-45-677 83-344 338-641 666-774 116-47 205-69 330-80 412-39 811 153 1040 5e2 193 292 240 648 128 981-135 403-492 699-914 757-1e2 14-241 12-337-4z"/></g></svg></a><p class=footnote>&copy; 2019
• <a class="p-name u-url" href=https://sequr.be>DezeStijn</a>
• &lt;a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0&lt;/a></p></div></aside><main class="content container"><div class=post><div class=info><h1 class=post-title><a href=https://dev.sequr.be/blog/hackthebox/challenge/hackthebox-emdeefiveforlife/>Emdee five for life</a></h1><div class=headline><div><span>DezeStijn - </span><time datetime=2019-08-13T09:04:52Z class=post-date>August 13, 2019
</time><span>- </span><span class=reading-time><span>2 mins read</span></span></div><ul class=tags><li class=tag-Challenge><a href=https://dev.sequr.be/tags/challenge>Challenge</a></li><li class=tag-HackTheBox.eu><a href=https://dev.sequr.be/tags/hackthebox.eu>HackTheBox.eu</a></li><li class=tag-L4mpje><a href=https://dev.sequr.be/tags/l4mpje>L4mpje</a></li><li class=tag-Web><a href=https://dev.sequr.be/tags/web>Web</a></li></ul></div></div><p><strong>Note to fellow-HTBers:</strong> Only write-ups of retired HTB machines or challenges are allowed.</p><h2 id=challenge-info>Challenge info</h2><p>Emdee five for life [by <a href=https://www.hackthebox.eu/home/users/profile/29267%22 target=_blank>L4mpje</a>]<br>Can you encrypt fast enough?</p><h2 id=the-challenge>The challenge</h2><p>When visiting the web page, you are greeted with a simple string and the instruction to enter the MD5 hash of said string.</p><figure class=center><img src=/img/htb-emdeefive-img1.png><figcaption class=center>Simple instructions</figcaption></figure><p>So I opened up a command terminal to calculate the MD5 hash of this string.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>$</span> python
</span></span><span style=display:flex><span>Python <span style=color:#ae81ff>2.7.16</span><span style=color:#f92672>+</span> (default, Jul  <span style=color:#ae81ff>8</span> <span style=color:#ae81ff>2019</span>, <span style=color:#ae81ff>09</span>:<span style=color:#ae81ff>45</span>:<span style=color:#ae81ff>29</span>) 
</span></span><span style=display:flex><span>[GCC <span style=color:#ae81ff>8.3.0</span>] on linux2
</span></span><span style=display:flex><span>Type <span style=color:#e6db74>&#34;help&#34;</span>, <span style=color:#e6db74>&#34;copyright&#34;</span>, <span style=color:#e6db74>&#34;credits&#34;</span> <span style=color:#f92672>or</span> <span style=color:#e6db74>&#34;license&#34;</span> <span style=color:#66d9ef>for</span> more information<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#f92672>import</span> hashlib
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> print hashlib<span style=color:#f92672>.</span>md5(<span style=color:#e6db74>&#34;whatever your string is&#34;</span>)<span style=color:#f92672>.</span>hexdigest()
</span></span><span style=display:flex><span><span style=color:#ae81ff>855</span>f938d67b52b5a7eb124320a21a139
</span></span></code></pre></div><p>Entering the resulting MD5 hash into the form results in a rather insulting message, calling me &ldquo;too slow&rdquo;. And a new string is given.</p><figure class=center><img src=/img/htb-emdeefive-img2.png><figcaption class=center>Too slow!</figcaption></figure><p>This calls for automation!</p><h2 id=automation>Automation</h2><p>I open up the tool present in any web app pentester&rsquo;s set: Burp Suite.<br>Note that the free version suffices to beat this challenge.</p><p>Activate the proxy, set up the browser to use this proxy and capture the POST request in which you submit anything.<br>Send this request to the Intruder module.</p><figure class=center><img src=/img/htb-emdeefive-img3.png><figcaption class=center>POST request in Intruder. Payload position marked.</figcaption></figure><p>Set the payload position to the value of the <code>hash</code> parameter.</p><p>The payload type will be <code>Recursive grep</code>, the extract grep will be defined in the Options tab.<br>Make sure you set Payload Processing to <code>Hash: MD5</code>.</p><figure class=center><img src=/img/htb-emdeefive-img4.png><figcaption class=center>Payloads configuration</figcaption></figure><p>Under the Options tab, we define the grep extration rule with which we&rsquo;ll capture the string to be hashed. Define the grep rule as From <code>[&lt;h3 align='center'>] to [&lt;/h3]</code>.<br>We&rsquo;ll also set a grep match rule which will help use later. Set a flag for <code>Too slow!</code>.</p><figure class=center><img src=/img/htb-emdeefive-img5.png><figcaption class=center>Options configuration</figcaption></figure><p>Launching the attack, you&rsquo;ll notice some request don&rsquo;t have a flag for &ldquo;Too slow!&rdquo;.
These are the ones in which Intruder was quick enough to calculate and submit the MD5 hash of the string.
Especially with the free version, which is throttled, you might need to wait for a few requests before pausing the attack.</p><figure class=center><img src=/img/htb-emdeefive-img6.png><figcaption class=center>Got the flag</figcaption></figure><p>Yet again a nice challenge by L4mpje!</p><hr><div class=footer><a class=previous-post href="https://dev.sequr.be/blog/hackthebox/machine/hackthebox-writeup/?ref=footer"><span style=font-weight:700>« Previous</span><br>Writeup</a><div class=next-post><a href="https://dev.sequr.be/blog/hackthebox/challenge/hackthebox-cartographer/?ref=footer"><span style=font-weight:700>Next »</span><br>Cartographer</a></div></div></div></main><div class=article-toc><div class=toc-wrapper><h4 id=contents></h4><nav id=TableOfContents><ul><li><a href=#challenge-info>Challenge info</a></li><li><a href=#the-challenge>The challenge</a></li><li><a href=#automation>Automation</a></li></ul></nav></div></div></div></body></html>