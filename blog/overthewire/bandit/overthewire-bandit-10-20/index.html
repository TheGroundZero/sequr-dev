<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en-us lang=en-us><head>&lt; <title itemprop=name>Bandit (10 -> 20) :: Sequr (dev)</title>
<script defer language=javascript type=text/javascript src=/js/bundle.min.145453261a7755f5042a854c4213501d215a8fbe34c08d181c40f803f1315e74.js></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=robots content="noodp, noydir"><meta name=googlebot content="noodp, noydir"><link rel=canonical href=https://dev.sequr.be/blog/overthewire/bandit/overthewire-bandit-10-20/ itemprop=url><meta name=url content="https://dev.sequr.be/blog/overthewire/bandit/overthewire-bandit-10-20/"><link rel=icon href=favicon.ico><meta itemprop=name content="Bandit (10 -> 20)"><meta itemprop=description content="Write-up of level 10 to 20 of the Bandit challenge on OverTheWire.org"><meta itemprop=datePublished content="2020-01-09T11:12:17+00:00"><meta itemprop=dateModified content="2020-01-09T11:12:17+00:00"><meta itemprop=wordCount content="1317"><meta itemprop=image content="https://dev.sequr.be/blog/overthewire/bandit/overthewire-bandit-10-20/otw-bandit.png"><meta itemprop=keywords content="Bandit,Over the Wire,OverTheWire"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://dev.sequr.be/blog/overthewire/bandit/overthewire-bandit-10-20/otw-bandit.png"><meta name=twitter:title content="Bandit (10 -> 20)"><meta name=twitter:description content="Write-up of level 10 to 20 of the Bandit challenge on OverTheWire.org"><meta property="og:url" content="https://dev.sequr.be/blog/overthewire/bandit/overthewire-bandit-10-20/"><meta property="og:site_name" content="Sequr (dev)"><meta property="og:title" content="Bandit (10 -> 20)"><meta property="og:description" content="Write-up of level 10 to 20 of the Bandit challenge on OverTheWire.org"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2020-01-09T11:12:17+00:00"><meta property="article:modified_time" content="2020-01-09T11:12:17+00:00"><meta property="article:tag" content="Bandit"><meta property="article:tag" content="Over the Wire"><meta property="article:tag" content="OverTheWire"><meta property="og:image" content="https://dev.sequr.be/blog/overthewire/bandit/overthewire-bandit-10-20/otw-bandit.png"><meta name=description content="Write-up of level 10 to 20 of the Bandit challenge on OverTheWire.org"><meta itemprop=description content="Write-up of level 10 to 20 of the Bandit challenge on OverTheWire.org"><meta property="og:updated_time" content="2020-01-09T11:12:17Z"><link rel=sitemap type=application/xml title=Sitemap href=https://dev.sequr.be/sitemap.xml><meta name=apple-mobile-web-app-title content="Sequr (dev)"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black"><link type=text/css rel=stylesheet href=/css/bundle.min.94a339836f89f0d25f31980cb6b0631da21e20af128308747ce44e0525eb16ef.css integrity="sha256-lKM5g2+J8NJfMZgMtrBjHaIeIK8Sgwh0fOROBSXrFu8=" crossorigin=anonymous><style>body{--sidebar-bg-color:#202020;--sidebar-img-border-color:#515151;--sidebar-p-color:#909090;--sidebar-h1-color:#FFF;--sidebar-a-color:#FFF;--sidebar-socials-color:#FFF;--text-color:#222;--bkg-color:#FAF9F6;--post-title-color:#303030;--list-color:#5A5A5A;--link-color:#268BD2;--date-color:#515151;--table-border-color:#E5E5E5;--table-stripe-color:#F9F9F9;--code-color:#000;--code-background-color:#E5E5E5;--code-block-color:#FFF;--code-block-background-color:#272822;--moon-sun-color:#FFF;--moon-sun-background-color:#515151}body.dark-theme{--text-color:#EEE;--bkg-color:#121212;--post-title-color:#DBE2E9;--list-color:#9D9D9D;--link-color:#268BD2;--date-color:#9A9A9A;--table-border-color:#515151;--table-stripe-color:#202020;--code-color:#FFF;--code-background-color:#515151;--code-block-color:#FFF;--code-block-background-color:#272822}body{background-color:var(--bkg-color)}</style></head><body><div class=wrapper><aside class=sidebar><div class="container sidebar-sticky"><div class=light-dark align=right><button class=btn-light-dark title="Toggle light/dark mode"><svg class="moon" width="1em" height="1em" viewBox="0 0 16 16"><path fill="currentcolor" d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/></svg><svg class="sun" width="1em" height="1em" viewBox="0 0 16 16"><path fill="currentcolor" d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></svg></button></div><div class=sidebar-about><h1 class=brand><a href=https://dev.sequr.be/><img src=logo.png alt="brand image">
</a><a href=https://dev.sequr.be/><h1>Sequr (dev)</h1></a></h1><p class=lead>Dev version of sequr.be. This site may break at any time.</p></div><nav><ul class=sidebar-nav><li class=heading><a href=/about/>About</a></li><li class=heading>Blog</li><li class=heading><a href=/privacy/>Privacy</a></li></ul></nav><a target=_blank class=social title="RSS Feed" href=/posts/index.xml><svg width="1em" height="1.2em" viewBox="0 0 1280 1280"><g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="currentcolor"><path d="M2295 11929c-284-12-642-45-707-65-17-5-18-63-18-1039 0-569 4-1036 8-1039 5-3 74 6 153 19 510 86 1168 95 1789 25 1348-153 2602-677 3670-1531 385-308 820-744 1126-1129 842-1060 1362-2313 1514-3650 70-621 61-1279-25-1789-13-79-22-148-19-153 3-4 471-8 1039-8h1035l5 23c51 225 85 942 67 1419-23 605-77 1044-198 1617-294 14e2-927 2734-1823 3846-1043 1295-2364 2259-3909 2854-1158 447-2451 656-3707 6e2z"/><path d="M2255 7845c-269-25-620-81-667-106-17-9-18-55-18-899 0-706 3-890 13-890 6 0 66 18 132 41 130 44 288 79 467 105 154 21 577 30 749 15 1207-107 2267-823 2814-1902 166-327 268-637 330-1001 38-227 48-384 42-662-8-348-44-590-126-831-23-66-41-126-41-132 0-10 184-13 890-13 844 0 890 1 899 18 27 50 88 452 110 725 14 162 14 624 1 782-59 703-233 1323-545 1945-481 956-1313 1788-2270 2268-620 310-1239 483-1940 542-165 14-669 10-840-5z"/><path d="M2519 3815c-391-66-725-336-868-703-79-201-96-462-45-677 83-344 338-641 666-774 116-47 205-69 330-80 412-39 811 153 1040 5e2 193 292 240 648 128 981-135 403-492 699-914 757-1e2 14-241 12-337-4z"/></g></svg></a><p class=footnote>&copy; 2019
• <a class="p-name u-url" href=https://sequr.be>DezeStijn</a>
• &lt;a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0&lt;/a></p></div></aside><main class="content container"><div class=post><div class=info><h1 class=post-title><a href=https://dev.sequr.be/blog/overthewire/bandit/overthewire-bandit-10-20/>Bandit (10 -> 20)</a></h1><div class=headline><div><span>DezeStijn - </span><time datetime=2020-01-09T11:12:17Z class=post-date>January 9, 2020
</time><span>- </span><span class=reading-time><span>7 mins read</span></span></div><ul class=tags><li class=tag-Bandit><a href=https://dev.sequr.be/tags/bandit>Bandit</a></li><li class="tag-Over The Wire"><a href=https://dev.sequr.be/tags/over-the-wire>Over The Wire</a></li><li class=tag-OverTheWire><a href=https://dev.sequr.be/tags/overthewire>OverTheWire</a></li></ul></div></div><h2 id=info>Info</h2><p>From the <a href=https://overthewire.org/wargames/ target=_blank>OverTheWire website</a>:</p><blockquote><p>The wargames offered by the OverTheWire community can help you to learn and practice security concepts in the form of fun-filled games.</p><p>~ OverTheWire.org</p></blockquote><h2 id=bandit>Bandit</h2><p>Bandit is the first series of challenges and it&rsquo;s recommended to start with these.</p><blockquote><p>The Bandit wargame is aimed at absolute beginners. It will teach the basics needed to be able to play other wargames.</p><p>~ OverTheWire.org</p></blockquote><p>Make sure you following along on the website to get more info on the goal of the challenges and the skills that you&rsquo;ll learn from them.</p><p>Always first try to do a challenge yourself.<br>You&rsquo;ll learn more and might find methodologies or techniques that work better for you.</p><p>This write-up contains the solution of levels 10 to 20.<br>Need to go back for <a href=/blog/overthewire/bandit/overthewire-bandit-0-10/>levels 0 to 10</a>?</p><h3 id=level-10---11>Level 10 -> 11</h3><p>Connect with the OverTheWire infrastructure using the credentials retrieved in the previous level.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ ssh bandit10@bandit.labs.overthewire.org -p <span style=color:#ae81ff>2220</span>                
</span></span><span style=display:flex><span>This is a OverTheWire game server. More information on http://www.overthewire.org/wargames
</span></span><span style=display:flex><span>                          
</span></span><span style=display:flex><span>bandit10@bandit.labs.overthewire.org<span style=color:#960050;background-color:#1e0010>&#39;</span>s password:
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit10@bandit:~$ base64 -d data.txt 
</span></span><span style=display:flex><span>The password is IF##########PR
</span></span></code></pre></div><h3 id=level-11---level-12>Level 11 -> Level 12</h3><p>This is basically ROT13. So to &ldquo;reverse&rdquo; this, we need to apply another round of ROT13 to the data.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit11@bandit:~$ cat data.txt | tr <span style=color:#e6db74>&#39;a-zA-Z&#39;</span> <span style=color:#e6db74>&#39;n-za-mN-ZA-N&#39;</span>
</span></span><span style=display:flex><span>The password is 5T##########Uu
</span></span></code></pre></div><h3 id=level-12---level-13>Level 12 -> Level 13</h3><p>As suggested by the level description, we first copy the data.txt file to a folder in <code>/tmp/</code> where we can create and move files.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit12@bandit:~$ mkdir /tmp/sequr
</span></span><span style=display:flex><span>bandit12@bandit:~$ cd /tmp/sequr
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ cp ~/data.txt .
</span></span></code></pre></div><p><code>data.txt</code> contains a hexdump, which we can easily confirm.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ head data.txt 
</span></span><span style=display:flex><span>00000000: 1f8b <span style=color:#ae81ff>0808</span> d7d2 c55b <span style=color:#ae81ff>0203</span> <span style=color:#ae81ff>6461</span> <span style=color:#ae81ff>7461</span> 322e  .......<span style=color:#f92672>[</span>..data2.
</span></span><span style=display:flex><span>00000010: <span style=color:#ae81ff>6269</span> 6e00 013c 02c3 fd42 5a68 <span style=color:#ae81ff>3931</span> <span style=color:#ae81ff>4159</span>  bin..&lt;...BZh91AY
</span></span><span style=display:flex><span>00000020: <span style=color:#ae81ff>2653</span> 591d aae5 <span style=color:#ae81ff>9800</span> 001b ffff de7f 7fff  &amp;SY.............
</span></span></code></pre></div><p>Reverse the hexdump, which gives us a gzip compressed container.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ xxd -r data.txt &gt; data-dedumped
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ file data-dedumped 
</span></span><span style=display:flex><span>data-dedumped: gzip compressed data, was <span style=color:#e6db74>&#34;data2.bin&#34;</span>, last modified: Tue Oct <span style=color:#ae81ff>16</span> 12:00:23 2018, max compres
</span></span><span style=display:flex><span>sion, from Unix
</span></span></code></pre></div><p>Decompress to get a bzip2 compressed container.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ mv data-dedumped data.gz
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ gunzip data.gz
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ file data
</span></span><span style=display:flex><span>data: bzip2 compressed data, block size <span style=color:#f92672>=</span> 900k
</span></span></code></pre></div><p>Decompress again (gzip).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ bzip2 -d data
</span></span><span style=display:flex><span>bzip2: Can<span style=color:#960050;background-color:#1e0010>&#39;</span>t guess original name <span style=color:#66d9ef>for</span> data -- using data.out
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ file data.out 
</span></span><span style=display:flex><span>data.out: gzip compressed data, was <span style=color:#e6db74>&#34;data4.bin&#34;</span>, last modified: Tue Oct <span style=color:#ae81ff>16</span> 12:00:23 2018, max compression, from Unix
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ mv data.out data.gz
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ gunzip data.gz
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ file data
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ mv data data.tar
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ tar -xf data.tar
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ file data5.bin 
</span></span><span style=display:flex><span>data5.bin: POSIX tar archive <span style=color:#f92672>(</span>GNU<span style=color:#f92672>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ tar -xf data5.bin
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ file data6.bin 
</span></span><span style=display:flex><span>data6.bin: bzip2 compressed data, block size <span style=color:#f92672>=</span> 900k
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ bzip2 -d data6.bin
</span></span><span style=display:flex><span>bzip2: Can<span style=color:#960050;background-color:#1e0010>&#39;</span>t guess original name <span style=color:#66d9ef>for</span> data6.bin -- using data6.bin.out
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ file data6.bin.out 
</span></span><span style=display:flex><span>data6.bin.out: POSIX tar archive <span style=color:#f92672>(</span>GNU<span style=color:#f92672>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ tar -xf data6.bin.out
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ file data8.bin 
</span></span><span style=display:flex><span>data8.bin: gzip compressed data, was <span style=color:#e6db74>&#34;data9.bin&#34;</span>, last modified: Tue Oct <span style=color:#ae81ff>16</span> 12:00:23 2018, max compression, from Unix
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ mv data8.<span style=color:#f92672>{</span>bin,gz<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ gzip -d data8.gz
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ file data8
</span></span><span style=display:flex><span>data8: ASCII text
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ cat data8
</span></span><span style=display:flex><span>The password is 8Z##########YL
</span></span></code></pre></div><p>Should have automated this somehow …</p><h3 id=level-13---level-14>Level 13 -> Level 14</h3><p>We get a private SSH key for bandit14. So copy this to your local system.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit13@bandit:~$ cat sshkey.private 
</span></span><span style=display:flex><span>-----BEGIN RSA PRIVATE KEY-----
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>Make sure you set the permissions right (i.e. only the owner should be able to read it), otherwise OpenSSH will refuse to use your key.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ chmod <span style=color:#ae81ff>600</span> bandit14_ssh.private
</span></span><span style=display:flex><span>$ ssh -i bandit14_ssh.private bandit14@bandit.labs.overthewire.org -p <span style=color:#ae81ff>2220</span>
</span></span><span style=display:flex><span>bandit14@bandit:~$ cat /etc/bandit_pass/bandit14
</span></span><span style=display:flex><span>4w##########3e
</span></span></code></pre></div><h3 id=level-14---level-15>Level 14 -> Level 15</h3><p>We can use netcat (<code>nc</code>) to openen a network connection to a specific port.</p><p>Once the connection is opened, we enter the required data. The server then responds with the next level&rsquo;s password.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit14@bandit:~$ nc localhost <span style=color:#ae81ff>30000</span>
</span></span><span style=display:flex><span>4w##########3e
</span></span><span style=display:flex><span>Correct!
</span></span><span style=display:flex><span>Bf##########xNr
</span></span></code></pre></div><h3 id=level-15---level-16>Level 15 -> Level 16</h3><p>Since the service on this port uses SSL encryption, we&rsquo;ll need to use a client that&rsquo;s capable of setting up such a connection. OpenSSL provides such a client.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit14@bandit:~$ openssl s_client -connect localhost:30001                                                                                                                                  
</span></span><span style=display:flex><span>CONNECTED<span style=color:#f92672>(</span>00000003<span style=color:#f92672>)</span>                                                                                                                                                                           
</span></span><span style=display:flex><span>depth<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span> CN <span style=color:#f92672>=</span> localhost                                                                                                                                                                        
</span></span><span style=display:flex><span>verify error:num<span style=color:#f92672>=</span>18:self signed certificate                                                                                                                                                   
</span></span><span style=display:flex><span>verify <span style=color:#66d9ef>return</span>:1                                                                                                                                                                               
</span></span><span style=display:flex><span>depth<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span> CN <span style=color:#f92672>=</span> localhost                                                                                                                                                                        
</span></span><span style=display:flex><span>verify <span style=color:#66d9ef>return</span>:1                                                                                                                                                                               
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>    Extended master secret: yes
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>Bf##########Nr
</span></span><span style=display:flex><span>Correct!
</span></span><span style=display:flex><span>cl##########hd
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>closed
</span></span></code></pre></div><h3 id=level-16---level-17>Level 16 -> Level 17</h3><p>First get the open ports</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit14@bandit:~$ nmap -v -p 31000-32000 --open localhost
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> localhost <span style=color:#f92672>(</span>127.0.0.1<span style=color:#f92672>)</span>                                                                                                                                                    
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.00021s latency<span style=color:#f92672>)</span>.                                                                                                                                                                
</span></span><span style=display:flex><span>Not shown: <span style=color:#ae81ff>999</span> closed ports                                                                                                                                                                   
</span></span><span style=display:flex><span>Some closed ports may be reported as filtered due to --defeat-rst-ratelimit                                                                                                                   
</span></span><span style=display:flex><span>PORT      STATE SERVICE                                                                                                                                                                       
</span></span><span style=display:flex><span>31518/tcp open  unknown                                                                                                                                                                       
</span></span><span style=display:flex><span>31790/tcp open  unknown
</span></span></code></pre></div><p>Then check the services they are running.<br>Note: you could actually immediately add the service scan (<code>-sV</code>) to the first scan.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit14@bandit:~$ nmap -v -sV -p 31518,31790 localhost
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.00023s latency<span style=color:#f92672>)</span>.                                                                                                                                                                
</span></span><span style=display:flex><span>Not shown: <span style=color:#ae81ff>999</span> closed ports                                                                                                                                                                   
</span></span><span style=display:flex><span>Some closed ports may be reported as filtered due to --defeat-rst-ratelimit                                                                                                                   
</span></span><span style=display:flex><span>PORT      STATE SERVICE     VERSION                                                                                                                                                           
</span></span><span style=display:flex><span>31518/tcp open  ssl/echo                                                                                                                                                                      
</span></span><span style=display:flex><span>31790/tcp open  ssl/unknown                                                                                                                                                                   
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :                  
</span></span><span style=display:flex><span>SF-Port31790-TCP:V<span style=color:#f92672>=</span>7.40%T<span style=color:#f92672>=</span>SSL%I<span style=color:#f92672>=</span>7%D<span style=color:#f92672>=</span>1/9%Time<span style=color:#f92672>=</span>5E17044C%P<span style=color:#f92672>=</span>x86_64-pc-linux-gn                                                                                                                    
</span></span><span style=display:flex><span>SF:u%r<span style=color:#f92672>(</span>GenericLines,31,<span style=color:#e6db74>&#34;Wrong!\x20Please\x20enter\x20the\x20correct\x20cur                                                                                                                    
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:rent\x20password\n&#34;</span><span style=color:#f92672>)</span>%r<span style=color:#f92672>(</span>GetRequest,31,<span style=color:#e6db74>&#34;Wrong!\x20Please\x20enter\x20the\
</span></span></span><span style=display:flex><span><span style=color:#e6db74>[...]
</span></span></span></code></pre></div><p>Port 31518 is running the echo service, which basically just returns whatever you send to it (hence: echo).<br>Port 31790 is running a SSL service nmap doesn&rsquo;t recognize (it failed to grab a banner and/or didn&rsquo;t recognize it). In the output you can see the &ldquo;fail&rdquo; strings which are returned if you send it an incorrect password.</p><p>Connect using openssl again. This time we get a SSH private key back.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit14@bandit:~$ openssl s_client -connect localhost:31790                                                                                                                                  
</span></span><span style=display:flex><span>CONNECTED<span style=color:#f92672>(</span>00000003<span style=color:#f92672>)</span>                                                                                                                                                                           
</span></span><span style=display:flex><span>depth<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span> CN <span style=color:#f92672>=</span> localhost
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>---                                                                                                                                                                                           
</span></span><span style=display:flex><span>cl##########hd                                                                                                                                                              
</span></span><span style=display:flex><span>Correct!                                                                                                                                                                                      
</span></span><span style=display:flex><span>-----BEGIN RSA PRIVATE KEY-----
</span></span><span style=display:flex><span>MIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJ
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>vBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY<span style=color:#f92672>=</span>            
</span></span><span style=display:flex><span>-----END RSA PRIVATE KEY-----                                                                  
</span></span><span style=display:flex><span>                                                                                               
</span></span><span style=display:flex><span>closed
</span></span></code></pre></div><h3 id=level-17---level-18>Level 17 -> Level 18</h3><p>First connect using the private key from the last level.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ ssh -i bandit17_ssh.private bandit17@bandit.labs.overthewire.org -p <span style=color:#ae81ff>2220</span>
</span></span></code></pre></div><p>We need to find the line that is _diff_erent between the two files.</p><p>Lines starting with a <code>&lt;</code> are present in FILE1 but not in FILE2.<br>Lines starting with a <code>></code> are present in FILE2 but not in FILE1.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit17@bandit:~$ diff passwords.old passwords.new 
</span></span><span style=display:flex><span>42c42
</span></span><span style=display:flex><span>&lt; hlbSBPAWJmL6WFDb06gpTx1pPButblOA
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>&gt; kf##########Yd
</span></span></code></pre></div><h3 id=level-18---level-19>Level 18 -> Level 19</h3><p>Notice the note at the previous level:</p><blockquote><p>NOTE: if you have solved this level and see ‘Byebye!’ when trying to log into bandit18, this is related to the next level, bandit19</p><p>~ OverTheWire.org</p></blockquote><p>This is exactly what happens when we try to SSH to the lab as bandit18.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ ssh bandit18@bandit.labs.overthewire.org -p <span style=color:#ae81ff>2220</span>                                                                                                                                        
</span></span><span style=display:flex><span>This is a OverTheWire game server. More information on http://www.overthewire.org/wargames
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>  Enjoy your stay!
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Byebye !
</span></span><span style=display:flex><span>Connection to bandit.labs.overthewire.org closed.
</span></span></code></pre></div><p>The level&rsquo;s description mentions that someone modified the <code>.bashrc</code> file to automatically log us out of a SSH connection.<br><code>.bashrc</code> is a configuration file used by the Bash shell, which is the default shell on many systems.</p><p>Let&rsquo;s ignore <code>.bashrc</code> by not using Bash as our shell. Let&rsquo;s use regular shell instead.<br>Note that we don&rsquo;t get the usual Prompt String (PS1) showing our username and path. However, we are still connected to the system and can execute commands.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ ssh bandit18@bandit.labs.overthewire.org -p <span style=color:#ae81ff>2220</span> /bin/sh
</span></span><span style=display:flex><span>This is a OverTheWire game server. More information on http://www.overthewire.org/wargames
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>bandit18@bandit.labs.overthewire.org<span style=color:#960050;background-color:#1e0010>&#39;</span>s password: 
</span></span><span style=display:flex><span>ls <span style=color:#75715e># command</span>
</span></span><span style=display:flex><span>readme <span style=color:#75715e># output</span>
</span></span><span style=display:flex><span>cat readme <span style=color:#75715e># command</span>
</span></span><span style=display:flex><span>Iu##########5x <span style=color:#75715e># output</span>
</span></span></code></pre></div><p>An alternative would&rsquo;ve been not to connect interactively, but use something like SCP (Secure File Copy), which is like FTP (File Transfer Protocol) but over Secure Shell (SSH). However, this level states that you should be able to finish it by only using SSH, ls and cat.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ scp -P <span style=color:#ae81ff>2220</span> bandit18@bandit.labs.overthewire.org:readme ./
</span></span><span style=display:flex><span>This is a OverTheWire game server. More information on http://www.overthewire.org/wargames
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>bandit18@bandit.labs.overthewire.org<span style=color:#960050;background-color:#1e0010>&#39;</span>s password: 
</span></span><span style=display:flex><span>readme                    100%   <span style=color:#ae81ff>33</span>     1.2KB/s   00:00
</span></span><span style=display:flex><span>$ cat readme 
</span></span><span style=display:flex><span>Iu##########5x
</span></span></code></pre></div><h3 id=level-19---level-20>Level 19 -> Level 20</h3><p>A setuid binary executes within the context of the user defined by the setuid. As such we can access a file which can only be read by bandit20 as the setuid binary executes under the privileges of that user.</p><p>This binary simply executes the commands passed as parameter, so we simply print the content of the password file.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit19@bandit:~$ ./bandit20-do cat /etc/bandit_pass/bandit20
</span></span><span style=display:flex><span>Gb##########0j
</span></span></code></pre></div><hr><div class=footer><a class=previous-post href="https://dev.sequr.be/blog/overthewire/bandit/overthewire-bandit-0-10/?ref=footer"><span style=font-weight:700>« Previous</span><br>Bandit (0 -> 10)</a><div class=next-post><a href="https://dev.sequr.be/blog/overthewire/bandit/overthewire-bandit-20-30/?ref=footer"><span style=font-weight:700>Next »</span><br>Bandit (20 -> 30)</a></div></div></div></main><div class=article-toc><div class=toc-wrapper><h4 id=contents></h4><nav id=TableOfContents><ul><li><a href=#info>Info</a></li><li><a href=#bandit>Bandit</a><ul><li><a href=#level-10---11>Level 10 -> 11</a></li><li><a href=#level-11---level-12>Level 11 -> Level 12</a></li><li><a href=#level-12---level-13>Level 12 -> Level 13</a></li><li><a href=#level-13---level-14>Level 13 -> Level 14</a></li><li><a href=#level-14---level-15>Level 14 -> Level 15</a></li><li><a href=#level-15---level-16>Level 15 -> Level 16</a></li><li><a href=#level-16---level-17>Level 16 -> Level 17</a></li><li><a href=#level-17---level-18>Level 17 -> Level 18</a></li><li><a href=#level-18---level-19>Level 18 -> Level 19</a></li><li><a href=#level-19---level-20>Level 19 -> Level 20</a></li></ul></li></ul></nav></div></div></div></body></html>